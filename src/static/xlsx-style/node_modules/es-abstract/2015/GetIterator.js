'use strict';

var GetIntrinsic = require('es-abstract/GetIntrinsic');

var $TypeError = GetIntrinsic('%TypeError%');

var getIteratorMethod = require('es-abstract/helpers/getIteratorMethod');
var AdvanceStringIndex = require('es-abstract/2015/AdvanceStringIndex');
var Call = require('es-abstract/2015/Call');
var GetMethod = require('es-abstract/2015/GetMethod');
var IsArray = require('es-abstract/2015/IsArray');
var Type = require('es-abstract/2015/Type');

// https://ecma-international.org/ecma-262/6.0/#sec-getiterator

module.exports = function GetIterator(obj, method) {
	var actualMethod = method;
	if (arguments.length < 2) {
		actualMethod = getIteratorMethod(
			{
				AdvanceStringIndex: AdvanceStringIndex,
				GetMethod: GetMethod,
				IsArray: IsArray,
				Type: Type
			},
			obj
		);
	}
	var iterator = Call(actualMethod, obj);
	if (Type(iterator) !== 'Object') {
		throw new $TypeError('iterator must return an object');
	}

	return iterator;
};
